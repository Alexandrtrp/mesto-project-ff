(()=>{"use strict";var t={576:(t,e,n)=>{t.exports=n.p+"0863e5bc26221680f1e2.svg"}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var c=e[o]={exports:{}};return t[o](c,c.exports,n),c.exports}function o(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",c)}function r(t){t.classList.remove("popup_is-opened"),t.removeEventListener("keydown",c)}function c(t){"Escape"===t.key&&r(document.querySelector(".popup_is-opened"))}function a(t){if(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))return r(t.currentTarget),!0}n.m=t,n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.p="",n.b=document.baseURI||self.location.href,n.d({},{I8:()=>g});var u="https://mesto.nomoreparties.co/v1/cohort-magistr-2",i="bc87767e-4fd6-4faf-bbe1-2b50fbc9866d",l="application/json",s=function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))};function p(t,e,n,o,r,c,a,u,i){var l=n.querySelector(".places__item").cloneNode(!0),s=l.querySelector(".card__image"),p=l.querySelector(".card__title"),d=l.querySelector(".card__delete-button"),f=l.querySelector(".card__like-button"),_=l.querySelector(".card__like-button_likes");return l.id=u,s.src=t,p.textContent=e,_.textContent=c.length,0!==c?c.forEach((function(t){t._id===g&&f.classList.add("card__like-button_is-active")})):_.textContent=0,a!==g&&(d.style="display: none;"),i(d),f.addEventListener("click",o),s.addEventListener("click",(function(n){return r(t,e)})),l}function d(t){var e,n=t.target.closest(".places__item").id;t.target.classList.contains("card__like-button_is-active")?(t.target.classList.remove("card__like-button_is-active"),(e=n,fetch("".concat(u,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:i,"Content-Type":l}}).then((function(t){s(t)})).then((function(t){return t.likes.length})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))).then((function(e){t.target.closest(".places__item").querySelector(".card__like-button_likes").textContent=e})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))):(t.target.classList.add("card__like-button_is-active"),function(t){return fetch("".concat(u,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:i,"Content-Type":l}}).then((function(t){return s(t)})).then((function(t){return t.likes.length})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))}(n).then((function(e){t.target.closest(".places__item").querySelector(".card__like-button_likes").textContent=e})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))})))}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}var _={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};function m(t,e,n){0!==t.length&&(function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.disabled=!0,e.classList.add(n)):(e.disabled=!1,e.classList.remove(n)))}function y(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);m(n,o,e.inactiveButtonClass),n.forEach((function(r){r.addEventListener("input",(function(){!function(t,e,n){if(e.validity.patternMismatch||e.validity.typeMismatch){e.setCustomValidity(e.dataset.errorMessageDefault);var o=["popup__input_type_name","popup__input_type_card-name"];e.validity.patternMismatch&&(r=e.classList,function(t){if(Array.isArray(t))return f(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).some((function(t){return o.includes(t)}))&&e.setCustomValidity(e.dataset.errorMessage)}else e.setCustomValidity("");var r;e.validity.valid?function(t,e,n){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(t,e,n):function(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(t,e,e.validationMessage,n)}(t,r,e),m(n,o,e.inactiveButtonClass)}))}))}function v(t,e){Array.from(t.querySelectorAll(e.inputSelector)).forEach((function(n){var o=t.querySelector(".".concat(n.id,"-error"));n.classList.remove(e.inputErrorClass),n.setCustomValidity(""),o.classList.remove(e.errorClass),o.textContent="",m(Array.from(t.querySelectorAll(e.inputSelector)),t.querySelector(e.submitButtonSelector),e.inactiveButtonClass)}))}var h=new URL(n(576),n.b);document.querySelector(".header__logo").src=h;var S,g="",b={},q=document.querySelector("#card-template").content,C=document.querySelector(".profile__edit-button"),L=document.querySelector(".profile__add-button"),k=document.querySelector(".places__list"),E=document.querySelector(".popup_type_edit"),x=document.querySelector(".popup_type_edit .popup__form"),A=document.querySelector(".popup__input_type_name"),T=document.querySelector(".popup__input_type_description"),w=document.querySelector(".profile__title"),z=document.querySelector(".profile__description"),O=document.querySelector(".popup_type_new-card"),P=document.querySelector(".popup__input_type_card-name"),j=document.querySelector(".popup__input_type_url"),B=document.querySelector(".popup_type_new-card .popup__form"),M=document.querySelector(".popup_type_image"),D=document.querySelector(".popup__image"),I=document.querySelector(".popup__caption"),N=document.querySelector(".popup__delete-card"),U=document.querySelector(".popup__delete-card .popup__button"),V=document.querySelector(".profile__image"),J=document.querySelector(".popup__new-avatar"),H=document.querySelector(".popup__input_type_url-avatar"),R=document.querySelector(".popup__new-avatar .popup__form");function $(t,e){o(M),D.src=t,I.textContent=e}function F(t,e){t.target.querySelector(".popup__button").textContent=e?"Сохранить":"Сохранение..."}function G(t){t.addEventListener("click",(function(t){o(N),t.target.closest(".places__item").classList.add("delete-target"),b=document.querySelector(".delete-target")}))}document.querySelectorAll(".popup").forEach((function(t){t.classList.add("popup_is-animated")})),Promise.all([function(){return fetch("".concat(u,"/users/me"),{headers:{authorization:i}}).then((function(t){return s(t)})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))},function(){return fetch("".concat(u,"/cards"),{headers:{authorization:i}}).then((function(t){return s(t)})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))}]).then((function(t){t[0]().then((function(t){g=t._id,w.textContent=t.name,z.textContent=t.about,document.querySelector(".profile__image").setAttribute("style","background-image: url(".concat(t.avatar,");"))})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))})),t[1]().then((function(t){t.forEach((function(t){k.append(p(t.link,t.name,q,d,$,t.likes,t.owner._id,t._id,G))}))})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))})),C.addEventListener("click",(function(t){A.value=w.textContent,T.value=z.textContent,o(E),v(x,_)})),L.addEventListener("click",(function(t){P.value="",j.value="",o(O),v(B,_)})),V.addEventListener("click",(function(t){H.value="",v(R,_),o(J)})),E.addEventListener("click",a),O.addEventListener("click",a),M.addEventListener("click",a),J.addEventListener("click",a),N.addEventListener("click",(function(t){a(t)&&b.classList.remove("delete-target")})),U.addEventListener("click",(function(t){var e;(e=b.id,fetch("".concat(u,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:i,"Content-Type":l}}).then((function(t){return s(t)})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))})).finally((function(t){!function(t){t.closest(".places__item").remove()}(b),r(N)}))})),x.addEventListener("submit",(function(t){var e,n;t.preventDefault(),F(t),(e=A.value,n=T.value,fetch("".concat(u,"/users/me"),{method:"PATCH",headers:{authorization:i,"Content-Type":l},body:JSON.stringify({name:e,about:n})}).then((function(t){return s(t)})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))).then((function(t){w.textContent=A.value,z.textContent=T.value})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))})).finally((function(e){t.target.reset(),F(t,e),r(E)}))})),B.addEventListener("submit",(function(t){t.preventDefault();var e=P.value,n=j.value;F(t),function(t,e){return fetch("".concat(u,"/cards"),{method:"POST",headers:{authorization:i,"Content-Type":l},body:JSON.stringify({name:t,link:e})}).then((function(t){return s(t)})).then((function(t){return t._id})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))}(e,n).then((function(t){k.prepend(p(n,e,q,d,$,0,g,t,G))})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))})).finally((function(e){F(t,e),B.reset(),r(O)}))})),R.addEventListener("submit",(function(t){var e;t.preventDefault(),F(t),(e=H.value,fetch("".concat(u,"/users/me/avatar "),{method:"PATCH",headers:{authorization:i,"Content-Type":l},body:JSON.stringify({avatar:e})}).then((function(t){return s(t)})).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))}))).catch((function(t){return console.log("Ошибка. Запрос не выполнен: ".concat(t))})).finally((function(e){F(t,e),V.style="background-image: url(".concat(H.value,");"),R.reset(),r(J)}))})),S=_,Array.from(document.querySelectorAll(S.formSelector)).forEach((function(t){y(t,S)}))})();